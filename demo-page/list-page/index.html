<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="./css.css">
  <link rel="stylesheet" href="./webkit_toolbar.css">
  <style>
    @import url(https://fonts.bunny.net/css?family=roboto:300,400,500,700);
  </style>
  <style>
    @import url(https://fonts.bunny.net/css?family=noto-sans-kr:300,400,500,700);
  </style>
  <style>
    @import url(https://fonts.bunny.net/css?family=inter:300,400,500,700);
  </style>
  <style>
    @import url(https://fonts.bunny.net/css?family=noto-sans:300,400,500,700);
  </style>
  <style>
    @import url(https://fonts.bunny.net/css?family=ibm-plex-sans:300,400,500,700);
  </style>
  <style>
    @import url(https://fonts.bunny.net/css?family=nanum-gothic:300,400,500,700);
  </style>
  <!-- Editor's Style -->
</head>

<body>
  <div id="root" class="container">
    <div class="bottom-toolbar-container hidden">
      <input hidden value id="ticketIds" />
      <button class="bottom-toolbar-btn">
        Print
      </button>
      <button class="bottom-toolbar-btn">
        Export
      </button>
    </div>
    <div class="toolbar-container">
      <div class="toolbar-container-left">
        <!-- Filter -->
        <nav role="navigation" class="primary-navigation">
          <ul>
            <li><a class="groupBy selected" href="#">Group By &dtrif;</a></a>
              <ul class="dropdown">
                <li><a class="filter groupBy" href="all"> All Tickets</a></li>
                <li><a class="filter groupBy" href="resolved">Resolved Tickets</a></li>
                <li><a class="filter groupBy" href="closed">Closed Tickets</a></li>
                <li><a class="filter groupBy" href="my">My Tickets</a></li>
                <li><a class="filter groupBy" href="myResolved">My Resolved Tickets</a></li>
                <li><a class="filter groupBy" href="myClosed">My Closed Tickets</a></li>
              </ul>
            </li>
            <li><a href="#">Filter By &dtrif;</a>
              <form class="form-container">
                <ul class="dropdown">
                  <li>

                    <details>
                      <summary>Priority</summary>
                      <div class="autocomplete" style="width:300px;">
                      <input style="width: 100%;" name="priority" data-key="priority-write" />
                      </div>
                    </details>
                  </li>
                  <li>
                    <details>
                      <summary>Category</summary>
                      <input style="width: 100%;" name="category" data-key="category-write" />
                    </details>
                  </li>
                  <li>
                    <details>
                      <summary>Classfication</summary>
                      <input style="width: 100%;" name="classfications" data-key="classfications-write" />
                    </details>
                  </li>
                  <li>
                    <details>
                      <summary>Created Date</summary>
                      <input style="width: 100%;" name="createdAt" data-key="createdAt-write" type="date" />
                    </details>
                  </li>
                  <li>
                    <details>
                      <summary>Updated Date</summary>
                      <input style="width: 100%;" name="updatedAt" data-key="updatedAt-write" type="date" />
                    </details>
                  </li>
                  <li>
                    <details>
                      <summary>1st Responded Date</summary>
                      <input style="width: 100%;" name="firstResponseDue" data-key="firstResponseDue-write"
                        type="date" />
                    </details>
                  </li>
                  <li>
                    <details>
                      <summary>Resolved Date</summary>
                      <input style="width: 100%;" name="resolvedDate" data-key="resolvedAt-write" type="date" />
                    </details>
                  </li>
                  <li>
                    <details>
                      <summary>Closed Date</summary>
                      <input style="width: 100%;" name="closedAt" data-key="closedAt-write" type="date" />
                    </details>
                  </li>
                  <li>
                    <div class="button-group">
                      <button id="buttonCloseDialog" type="button">Cancel</button>
                      <button id="buttonSaveDialog" class="save-btn" type="submit" value="Submit">Save</button>
                    </div>
                  </li>
                </ul>
              </form>
            </li>

            <li><a href="#">Sort By &dtrif;</a>
              <ul class="dropdown">
                <li><a class="filter sortBy" href="subject">Subject </a></li>
                <li><a class="filter sortBy" href="code">Ticket ID</a></li>
                <li><a class="filter sortBy" href="createdAt">Created Date</a></li>
                <li><a class="filter sortBy" href="firstRespondDue">1st Response Due</a></li>
                <li><a class="filter sortBy" href="resolutionDue">Resolution Due</a></li>
                <li><a class="filter sortBy" href="closedAt">Closed Date</a></li>
              </ul>
            </li>
          </ul>
        </nav>
        <!-- end of filter -->
      </div>
      <div class="toolbar-container-right">
        <form class="search-form">
          <div class="search-container">

            <input type="text" placeholder="Search..." value="" class="search-input" name="subject" />
            <svg aria-hidden="true" viewBox="0 0 24 24" data-testid="SearchIcon" id="search-icon">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z">
              </path>
            </svg>
            <fieldset aria-hidden="true" class="search-icon-box">
              <legend id="i0q4o">
                <span class="notranslate">&ZeroWidthSpace;</span>
              </legend>
            </fieldset>



          </div>
        </form>
      </div>
    </div>

    <table id="list-table">
      <th><input type="checkbox" id="all-checkbox" name="all-select" value="all"></th>
      <th class="hidden" data-type="column-list" data-key="subject">Subject</th>
      <th class="hidden" data-type="column-list" data-key="category">Category</th>
      <th class="hidden" data-type="column-list" data-key="stage">Stage</th>
      <th class="hidden" data-type="column-list" data-key="status">Status</th>
      <th class="hidden" data-type="column-list" data-key="assignedUser">Assigned Rep</th>
      <th class="hidden" data-type="column-list" data-key="resolvedDate">Resolved Date</th>
      <th class="hidden" data-type="column-list" data-key="closedAt">Close Date</th>


      <tr data-type="list-common">
        <td><input type="checkbox" data-key="select-list" value="123"></td>
        <td class="hidden" data-type="column-list" data-key="subject"><a data-key="subject-list" class="title-text">Amet
            minim mollit non deserunt ullamco est si venimollit est</a></td>
        <td class="hidden" data-type="column-list" data-key="category">
          <div data-key="category-list">Error/Product A</div>
        </td>
        <td class="hidden" data-type="column-list" data-key="stage">
          <div class="priority-chip">
            <div class="chip-title" data-key="stage-list">Open</div>
          </div>
        </td>
        <td class="hidden" data-type="column-list" data-key="status">
          <div class="priority-chip">
            <div class="chip-title" data-key="status-list">Waiting</div>
          </div>
        </td>
        <td class="hidden" data-type="column-list" data-key="assignedUser">
          <div data-key="assignedUser-list">Robert Fox</div>
        </td>
        <td class="hidden" data-type="column-list" data-key="resolvedDate"><span
            data-key="resolvedDate-list">2023-06-20</span> </td>
        <td class="hidden" data-type="column-list" data-key="closedAt"><span data-key="closedAt-list">2023-06-20</span>
        </td>

      </tr>

    </table>
    <div class="footer-list">
      <div class="pagination-container">
        <div class="typography"><span>Row per page
          </span></div>
        <nav role="navigation" class="primary-navigation">
          <ul>
            <li class="page-size-box"><a class="pageSize selected" href="#">5 &dtrif;</a></a>
              <ul class="dropdown">
                <li><a class="filter pageSize" href="5">5</a></li>
                <li><a class="filter pageSize" href="10">10</a></li>
                <li><a class="filter pageSize" href="15">15</a></li>
                <li><a class="filter pageSize" href="20">20</a></li>
              </ul>
            </li>
          </ul>
        </nav>



        <!-- <select name="pageSize" class="page-size-box">
          <option value="5">5</option>
          <option value="10">10</option>
          <option value="15">15</option>
          <option value="20">20</option>
        </select> -->
        <div class="typography"><span>1-5 of 13
          </span></div>
        <button class="pagination-btn">
          < </button>
            <button class="pagination-btn"> > </button>

      </div>
    </div>
  </div>

  <script src="script.js"></script>
  <!-- AutoComplete script -->
  <script>function autocomplete(autocomplete, arr) {
    /*the autocomplete function takes two arguments,
    the text field element and an array of possible autocompleted values:*/
    console.log(`autocomplete`,autocomplete)
  
    const inp = autocomplete.querySelector(".myInput")
    const container = autocomplete.querySelector(".input-container")
    const value = autocomplete.querySelector(".value-input")
  
  
    var currentFocus;
    /*execute a function when someone writes in the text field:*/
    inp.addEventListener("input", function(e) {
        var autoCompleteList, item, i, val = this.value;
        /*close any already open lists of autocompleted values*/
        closeAllLists();
        if (!val) { return false;}
        currentFocus = -1;
        console.log(`~~~~ val`,val)
        /*create a DIV element that will contain the items (values):*/
        autoCompleteList = document.createElement("DIV");
        autoCompleteList.setAttribute("id", this.id + "autocomplete-list");
        autoCompleteList.setAttribute("class", "autocomplete-items");
        /*append the DIV element as a child of the autocomplete container:*/
        this.parentNode.appendChild(autoCompleteList);
        /*for each item in the array...*/
        for (i = 0; i < arr.length; i++) {
          /*check if the item starts with the same letters as the text field value:*/
          if (arr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()) {
            /*create a DIV element for each matching element:*/
            item = document.createElement("DIV");
            if (value.value && JSON.parse(value.value).includes(arr[i])) {
              console.log(`~~~~~~~~~selected`)
              item.className = "selected"
            }
            /*make the matching letters bold:*/
            item.innerHTML = "<strong>" + arr[i].substr(0, val.length) + "</strong>";
            item.innerHTML += arr[i].substr(val.length);
            /*insert a input field that will hold the current array item's value:*/
            item.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
            /*execute a function when someone clicks on the item value (DIV element):*/
            item.addEventListener("click", function(e) {
                /*insert the value for the autocomplete text field:*/
            
                inp.value = ``
                const itemVal= this.getElementsByTagName("input")[0].value;
                if (!value.value) {
                  
                  value.value=JSON.stringify([this.getElementsByTagName("input")[0].value])
                }
                else {
                 let oldVal = JSON.parse(value.value)
                  oldVal.push(this.getElementsByTagName("input")[0].value)
  
                  console.log(`oldVal`,oldVal)
                 value.value = JSON.stringify(oldVal);
                }
                let chip = document.createElement("DIV");
                chip.className = "chip"
                chip.innerHTML = 
                `<span>${this.getElementsByTagName("input")[0].value}</span><svg class="delete-icon"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"></path></svg>`
                container.insertBefore(chip,inp);
                console.log(`value`,value.value);
                // assign delete onclick
                const deleteBtn= chip.querySelector('svg');
                console.log(`deleteBtn`,deleteBtn);
                deleteBtn.addEventListener("click", function() {
                  let curArr = JSON.parse(value.value);
                  if(curArr.includes(itemVal)) {
                    curArr = curArr.filter(e => e !== itemVal);
                  }
                  value.value = JSON.stringify(curArr);
                  chip.remove();
                })
  
            
                /*close the list of autocompleted values,
                
                (or any other open lists of autocompleted values:*/
                closeAllLists();
            });
            autoCompleteList.appendChild(item);
          }
        }
    });
    /*execute a function presses a key on the keyboard:*/
    inp.addEventListener("keydown", function(e) {
        var autocompleteList = document.getElementById(this.id + "autocomplete-list");
        if (autocompleteList) autocompleteList = autocompleteList.getElementsByTagName("div");
        if (e.keyCode == 40) {
          /*If the arrow DOWN key is pressed,
          increase the currentFocus variable:*/
          currentFocus++;
          /*and and make the current item more visible:*/
          addActive(autocompleteList);
        } else if (e.keyCode == 38) { //up
          /*If the arrow UP key is pressed,
          decrease the currentFocus variable:*/
          currentFocus--;
          /*and and make the current item more visible:*/
          addActive(autocompleteList);
        } else if (e.keyCode == 13) {
          /*If the ENTER key is pressed, prevent the form from being submitted,*/
          e.preventDefault();
          if (currentFocus > -1) {
            /*and simulate a click on the "active" item:*/
            if (autocompleteList) autocompleteList[currentFocus].click();
          }
        }
    });
    function addActive(autocompleteList) {
      /*a function to classify an item as "active":*/
      if (!autocompleteList) return false;
      /*start by removing the "active" class on all items:*/
      removeActive(autocompleteList);
      if (currentFocus >= autocompleteList.length) currentFocus = 0;
      if (currentFocus < 0) currentFocus = (autocompleteList.length - 1);
      /*add class "autocomplete-active":*/
      autocompleteList[currentFocus].classList.add("autocomplete-active");
    }
    function removeActive(autocompleteList) {
      /*a function to remove the "active" class from all autocomplete items:*/
      for (var i = 0; i < autocompleteList.length; i++) {
        autocompleteList[i].classList.remove("autocomplete-active");
      }
    }
    function closeAllLists(elmnt) {
      /*close all autocomplete lists in the document,
      except the one passed as an argument:*/
      var autocompleteList = document.getElementsByClassName("autocomplete-items");
      for (var i = 0; i < autocompleteList.length; i++) {
        if (elmnt != autocompleteList[i] && elmnt != inp) {
          autocompleteList[i].parentNode.removeChild(autocompleteList[i]);
        }
      }
    }
  
    /*execute a function when someone clicks in the document:*/
    document.addEventListener("click", function (e) {
        closeAllLists(e.target);
    });
  }
  
  /*initiate the autocomplete function on the "myInput" element, and pass along the countries array as possible autocomplete values:*/
  console.log(`document.getElementsByClassName("autocomplete")[0]`,document.getElementsByClassName("autocomplete")[0])
  
  const allac = document.querySelectorAll(".autocomplete");
  Array.from(allac).forEach((Element) => {
  
    const options = JSON.parse(Element.querySelector('.autocomplete-options').innerHTML);
  
    autocomplete(Element, options);
  })
  
  const formFilter = document.querySelector('#filter');
  formFilter.addEventListener('submit', (e)=> {
    const form = event.target;
    const data = new FormData(form);
    let nTicketData = {};
    for (const [key, value] of data) {
      if(['classifications','category','product'].includes(key)) {
        nTicketData = {
          ...nTicketData,
          [key]: JSON.parse(value)
        };
      } else {
        nTicketData = {
          ...nTicketData,
          [key]: value
        };
      }
    
      
    }
    console.log("data update",nTicketData)
    // mutationAdd(newParams);
    //Prvent the submit event
    event.preventDefault();
    event.stopPropagation();
    return false;
  })</script>
</body>

</html>